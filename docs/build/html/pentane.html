
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Tutorial for pentane molecule (user-define forcefields) &#8212; dl_field_tutorials 0.1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=9d6072eb" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=e1a75a79"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'pentane';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Tutorial for a Polyethylene Chain in a Xylene Solution" href="polyethylene-xylene.html" />
    <link rel="prev" title="Tutorial for an OPLS/2005 polyisoprene chain" href="polyisoprene_melt.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">dl_field_tutorials 0.1 documentation</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">ðŸ“š Contents:</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="box_of_water.html">Tutorial for box of rigid water</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyisoprene_melt.html">Tutorial for an OPLS/2005 polyisoprene chain</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Tutorial for pentane molecule (user-define forcefields)</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyethylene-xylene.html">Tutorial for a Polyethylene Chain in a Xylene Solution</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/pentane.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Tutorial for pentane molecule (user-define forcefields)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#contents">Contents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#running-dl-field-without-udff-opls2005">Running DL_FIELD without UDFF (OPLS2005)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-udff-file-format">The UDFF file format</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modifying-opls2005-with-udff">Modifying OPLS2005 with UDFF</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#running-dl-field-with-udff">Running DL_FIELD with UDFF</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="tutorial-for-pentane-molecule-user-define-forcefields">
<h1>Tutorial for pentane molecule (user-define forcefields)<a class="headerlink" href="#tutorial-for-pentane-molecule-user-define-forcefields" title="Link to this heading">#</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following tutorial assumes you have compiled DL_field and are working from the <strong>dl_f_&lt;version&gt;</strong> directory. Please visit
the <a class="reference internal" href="getting_started.html"><span class="doc">getting started</span></a> page before starting.</p>
</div>
<p>DL_FIELD provides users with a range of commonly used MD forcefields (see reference manual). However, sometimes we may wish to use a forcefield (FF) not already provided,
or change some parameters in an existing FF. DL_FIELD offers a clean and intuitive way to
achieve this, which is demonstrated in the following tutorial.</p>
<section id="contents">
<h2>Contents<a class="headerlink" href="#contents" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="#no-udff"><span class="std std-ref">Running DL_FIELD without UDFF (OPLS2005)</span></a></p></li>
<li><p><a class="reference internal" href="#udff-file"><span class="std std-ref">The UDFF file format</span></a></p></li>
<li><p><a class="reference internal" href="#mod-udff"><span class="std std-ref">Modifying OPLS2005 with UDFF</span></a></p></li>
<li><p><a class="reference internal" href="#with-udff"><span class="std std-ref">Running DL_FIELD with UDFF</span></a></p></li>
</ul>
</section>
<section id="running-dl-field-without-udff-opls2005">
<span id="no-udff"></span><h2>Running DL_FIELD without UDFF (OPLS2005)<a class="headerlink" href="#running-dl-field-without-udff-opls2005" title="Link to this heading">#</a></h2>
<p>We will first assign parameters to a simple pentane molecule using the OPLS2005 FF. You can
access the input structure in <em>xyz</em> format <a class="reference external" href="_static/pentane.xyz">here</a>. Save this to the
<strong>tutorial_confs/</strong> directory (or change its PATH in the <em>control</em> file). We can then use the
following <em>control</em> file options:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Control file for pentane.xyz
1        * Construct DL_POLY output files
gromacs        * Seconday output files (gromacs, lammps, chemshell or none).
opls2005  * Type of force field require (see list below for choices).
kJ/mol  * Energy unit: kcal/mol, kJ/mol, eV, or K.
normal  * Conversion criteria (strict, normal, loose)
1        * Bond type (0=default, 1=harmonic , 2=Morse)
1        * Angle type (0=default, 1=harmonic, 2=harmonic cos)
none  * Include user-defined information. Put &#39;none&#39; or a .udff filename
1       * Verbosity mode: 1 = on, 0 = off
tutorial_confs/pentane.xyz  * Configuration file.
none   * Output file in PDB. Put &#39;none&#39; if not needed.
0 0.1 mol/dm^3  15.0 * Solution Maker: on/off, density, unit, cutoff)
0        * Optimise FIELD output size, if possible? 1=yes  0=no
2         * Atom display: 1 = DL_FIELD format. 2 = Standard format
2         * Vdw display format: 1 = 12-6 format   2 = LJ format
default * Epsilon mixing rule (organic FF only) : default, or 1 = geometric, 2 = arithmatic
default   * Sigma mixing rule (organic FF only) : default, or 1 = geometric, 2 = arithmatic
1        * Epsilon mixing rule (inorganic FF only) : 1 = geometric   2 = arithmatic
2        * Sigma mixing rule (inorganic FF only) : 1 = geometric   2 = arithmatic
1    * Epsilon mixing rule (BETWEEN different FF) : 1 = geometric   2 = arithmatic
2     * Sigma mixing rule (BETWEEN different FF): 1 = geometric 2 = arithmatic
0         * Display additional info. for protein 1=Yes  0=No
0         * Freeze atoms? 1 = Yes (see below)  0 = No
0         * Tether atoms? 1 = Yes (see below)  0 = No
0         * Constrain bonds? 1 = Yes (see below) 0 = No
0         * Apply rigid body? 1 = Yes (see below) 0 = No
0        * Periodic condition ? 0=no, other number = type of box (see below)
60.0 0.0   0.0 * Cell vector a (x, y, z)
0.0  60.0   0.0  * Cell vector b (x, y, z)
0.0   0.0  60.0 * Cell vector c (x, y, z)
default   * 1-4 scaling for coulombic (put default or x for scaling=x)
default   * 1-4 scaling for vdw (put default or x for scaling=x)
0  300.0  * Include velocity? 1=yes, 0=no and scaling temperature.
1         * Position solute at origin? 1 = yes, 0=no
none  1.9 * Solvate model? none or specify solvent (see below) and distance criteria.
0  10.0   * Add counter ions? 1=yes, 0=no,  minimum distance from solute
0        * MM energy calculation. 1=Yes, 0=No
20.0     * Cut off for electrostatic energy calculation (angstrom)
20.0      * Cut off for vdw energy calculation (angstrom)

************* DL_POLY control ******************
0          * Run DL_POLY program
DLPOLY_AMD.Z   * DL_POLY executable filename
/home/user_pc/DL_POLY/  * absolute path to DL_POLY program
8          * Number of processors (mpirun)
0          * MM calculation 1=on  0=off
3   5000   * Structural Relaxation level (0 - off, 1,2 or 3). Total timestep
8.0        * cutoff (vdw and electrostatic)
100000       * Time limit for DL_POLY run (in seconds)

************* Gromacs control ******************
0            * Run Gromacs
gmx          * Gromacs executable filename
/usr/bin/ * absolute path to Gromacs
1            * MM single-point calc.


########################################################
Atom state specification:  type  Molecular_Group   filter   [value]

#########################################################

Please do not remove those &#39;####&#39; lines.
All select atom commands must be included within the two &#39;####&#39; lines

Some remarks...
...
...
...
</pre></div>
</div>
<p>This instructs DL_FIELD to produce GROMACS and DL_POLY input files as outputs. For additional
guidance and notes on creating a suitable <em>control</em> file, please visit the
<a class="reference external" href="polyisoprene_melt">polyisoprene tutorial</a>.</p>
<p>Successfully running the program (from the <strong>dl_f_4.6/</strong> home directory) with the command</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>./dl_field
</pre></div>
</div>
<p>provides us with a set of output files in <strong>dl_f_4.XX/output/</strong>.</p>
<p>We could use these files for our simulations, but the alternative updated OPLS/2020 forcefield
offers improved errors on experimental properties, such as density and heats of vaporisation, along
with accurate self-diffusion coefficients for liquid alkanes [1]. However, since DL_FIELD does not
natively provide this FF, we can use a <em>udff</em> (user-define FF) file to change the
parameters ourselves.</p>
</section>
<section id="the-udff-file-format">
<span id="udff-file"></span><h2>The UDFF file format<a class="headerlink" href="#the-udff-file-format" title="Link to this heading">#</a></h2>
<p>The <em>udff</em> file allows users to define new FF models or change model parameters without
having to change the FF library files located in the <strong>lib/</strong> directory. As such, is uses the
same <em>DIRECTIVES</em> as the <em>.sf</em> and <em>.par</em> files. The general format is provided below</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>POTENTIAL opls2005

UNIT kcal/mol


[OPTIONAL DIRECTIVES]


END POTENTIAL
</pre></div>
</div>
<p>The only compulsory <em>DIRECTIVES</em> are POTENTIAL, END POTENTIAL and UNIT. The POTENTIAL
<em>DIRECTIVE</em> defines the location of relevant FF data. Because we are modifying the OPLS2005
model, this is what we specify. UNIT defines the energy units of any potential parameters in the
<em>udff</em>, and DL_FIELD converts these automatically into the units specified in the <em>control</em> file.
Finally, END POTENTIAL is placed at the end of the <em>udff</em> and encloses all optional <em>DIRECTIVES</em>.</p>
</section>
<section id="modifying-opls2005-with-udff">
<span id="mod-udff"></span><h2>Modifying OPLS2005 with UDFF<a class="headerlink" href="#modifying-opls2005-with-udff" title="Link to this heading">#</a></h2>
<p>In the OPLS/2020 FF, the following changes were made to the OPLS2005 parameters (in bold)</p>
<div class="pst-scrollable-table-container"><table class="table" id="id1">
<caption><span class="caption-text">Torsion Coefficients</span><a class="headerlink" href="#id1" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 18.2%" />
<col style="width: 27.3%" />
<col style="width: 18.2%" />
<col style="width: 18.2%" />
<col style="width: 18.2%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>torsion</p></th>
<th class="head"><p>V_1</p></th>
<th class="head"><p>V_2</p></th>
<th class="head"><p>V_3</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>OPLS2005</p></td>
<td><p>CT-CT-CT-CT</p></td>
<td><p>1.30</p></td>
<td><p>-0.05</p></td>
<td><p>0.20</p></td>
</tr>
<tr class="row-odd"><td><p>OPLS/2020</p></td>
<td><p>CT-CT-CT-CT</p></td>
<td><p><strong>0.85</strong></p></td>
<td><p><strong>-0.20</strong></p></td>
<td><p>0.20</p></td>
</tr>
</tbody>
</table>
</div>
<div class="pst-scrollable-table-container"><table class="table" id="id2">
<caption><span class="caption-text">Non-bonded parameters</span><a class="headerlink" href="#id2" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 22.2%" />
<col style="width: 11.1%" />
<col style="width: 16.7%" />
<col style="width: 16.7%" />
<col style="width: 16.7%" />
<col style="width: 16.7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>atom</p></th>
<th class="head"><p>q</p></th>
<th class="head"><p>OPLS2005</p></th>
<th class="head"></th>
<th class="head"><p>OPLS/2020</p></th>
<th class="head"></th>
</tr>
<tr class="row-even"><th class="head"></th>
<th class="head"></th>
<th class="head"><p>Ïƒ</p></th>
<th class="head"><p>Îµ</p></th>
<th class="head"><p>Ïƒ</p></th>
<th class="head"><p>Îµ</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>H</p></td>
<td><p>0.06</p></td>
<td><p>2.500</p></td>
<td><p>0.030</p></td>
<td><p><strong>2.480</strong></p></td>
<td><p><strong>0.026</strong></p></td>
</tr>
<tr class="row-even"><td><p>CH<sub>2</sub></p></td>
<td><p>âˆ’0.18</p></td>
<td><p>3.500</p></td>
<td><p>0.066</p></td>
<td><p><strong>3.510</strong></p></td>
<td><p>0.066</p></td>
</tr>
<tr class="row-odd"><td><p><em>n</em>-CH<sub>3</sub></p></td>
<td><p>âˆ’0.18</p></td>
<td><p>3.500</p></td>
<td><p>0.066</p></td>
<td><p><strong>3.550</strong></p></td>
<td><p>0.066</p></td>
</tr>
</tbody>
</table>
</div>
<p>We can make these changes to the OPLS2005 FF without affecting the rest of the parameters by
including more DIRECTIVES in our <em>udff</em> file. If we were only interested in modifying the
CT-CT-CT-CT dihedral parameters, we could use the DIHEDRAL and END DIHEDRAL
DIRECTIVES alone:</p>
<blockquote>
<div><div class="highlight-text notranslate"><div class="highlight"><pre><span></span>POTENTIAL ...

UNIT ...

DIHEDRAL
CT   CT   CT   CT   0.85   -0.20   0.20
END DIHEDRAL

END POTENTIAL
</pre></div>
</div>
</div></blockquote>
<p>However, the OPLS/2020 FF makes a distinction between the non-bonded interaction parameters of the
C in CH3 and C in CH2 atoms, which are represented with the same atom type (ATOM_KEY CT) under
the OPLS2005 FF. Therefore, we can use a MOLECULE template where we define a new ATOM_TYPE to
account for this difference using the <em>ATOM_TYPE</em> <em>DIRECTIVE</em>:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>...

ATOM_TYPE     key     element    mass     remark
Cp_alk_2020    CT3     C        12.0115    ! OPLS/2020 CH3
END ATOM_TYPE
...
</pre></div>
</div>
<p>The DIRECTIVE takes 5 inputs: the ATOM_TYPE, ATOM_KEY, atomic element, molecular mass, and a remark
which is ignored by DL_FIELD. In order for DL_FIELD to recognise the new atom type, we also have to define it
in the <strong>lib/dl_field.atom_type</strong> file in the following section:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>----------------------------------------
January 2015 C W Yong
Revised January 2016
Use ATOM_TYPE to determine OPLS2005 type
for BCI determination.
Do not use DL_FIELD type to determine BCI
DL_FIELD   OPLS2005
CT         C135      Cp_alk_2020 * add this line
CT         C135      C_alkane
CT         C135      Cp_alkane
CT         C135      Cs_alkane
...
</pre></div>
</div>
<p>We then define our new MOLECULE, and its connections, which includes
the new ATOM_TYPE with the MOLECULE_TYPE and MOLECULE DIRECTIVES:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>...

MOLECULE_TYPE MOLECULE_KEY total_mass
pentane        PENT         72.1531  ! C5H12
END MOLECULE_TYPE



MOLECULE pentane 17 0
C1   Cp_alk_2020 -0.18
H11  HC_alkane  0.06              H11 H21 H31 H41 H51
H12  HC_alkane  0.06              |   |   |   |   |
H13  HC_alkane  0.06          H12-C1--C2--C3--C4--C5-H62
C2   Cs_alkane -0.12              |   |   |   |   |
H21  HC_alkane  0.06             H13 H22 H32 H42 H52
H22  HC_alkane  0.06
C3   Cs_alkane -0.12
H31  HC_alkane  0.06
H32  HC_alkane  0.06
C4   Cs_alkane -0.12
H41  HC_alkane  0.06
H42  HC_alkane  0.06
C5   Cp_alk_2020 -0.18
H51  HC_alkane  0.06
H62  HC_alkane  0.06
H52  HC_alkane  0.06
CONNECT C1  &gt; H11 H12 H13 C2
CONNECT H11 &gt; C1
CONNECT H12 &gt; C1
CONNECT H13 &gt; C1
CONNECT C2  &gt; C1 H21 H22 C3
CONNECT H21 &gt; C2
CONNECT H22 &gt; C2
CONNECT C3  &gt; H31 H32 C2 C4
CONNECT H31 &gt; C3
CONNECT H32 &gt; C3
CONNECT C4  &gt; H41 H42 C3 C5
CONNECT H41 &gt; C4
CONNECT H42 &gt; C4
CONNECT C5  &gt; H51 H62 H52 C4
CONNECT H51 &gt; C5
CONNECT H62 &gt; C5
CONNECT H52 &gt; C5
END MOLECULE

...
</pre></div>
</div>
<p>The MOLECULE_TYPE DIRECTIVE defines the MOLECULE_TYPE (pentane), MOLECULE_KEY and total mass of the
MOLECULE. The MOLECULE_KEY is an important MOLECULE identifier which will be used in its <em>pdb</em> file.
To conform to the <em>pdb</em> format, it can be up to 4 characters long.</p>
<p>The MOLECULE directive then defines each ATOM in the MOLECULE, along with their explicit connections
via the CONNECT DIRECTIVE. Here, there are additional optional DIRECTIVES which can exclude or only
include certain MOLECULE interactions, which we will not make use of in this tutorial. Consult the
reference manual for more information.</p>
<p>An issue with defining a new ATOM_TYPE is that now we have to explicitly include every relevant
BOND, ANGLE and DIHEDRAL parameter which includes it, most of which remain unchanged
from the OPLS2005 FF. This would be tedious, so DL_FIELD provides an EQUIVALENCE DIRECTIVE to help.
We can use this to match FF parameters of different ATOM_KEYS. For our MOLECULE:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>...

EQUIVALENCE
CT3  &gt;  bond_CT angle_CT dihedral_CT inv_CT imp_CT shell_CT tbp_CT
END EQUIVALENCE

...
</pre></div>
</div>
<p>This treats the CT3 ATOM_KEY associated with our newly defined ATOM_TYPE as the ATOM_TYPE CT, and
assigns its FF parameters accordingly. In this example, we have done so for every parameter
except the non-bonded ones (vdw_CT), which differ between CT and CT3 atoms. For more information,
consult the reference manual.</p>
<p>Finally, we need to complete the <em>udff</em> file by modifying the required FF paramaters. Note that, since,
we matched the CT3 and CT DIHEDRAL parameters, we only need to define one new dihedral.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>...

VDW
CT  3.510 0.066
CT3 3.550 0.066
HC  2.480 0.026
END VDW

DIHEDRAL
CT   CT   CT   CT   0.85  -0.20  0.20
END DIHEDRAL

...
</pre></div>
</div>
<p>Here, the VDW DIRECTIVE defines new Ïƒ and Îµ values for ATOM_TYPES CT, CT3 and HC; which are all modified under the OPLS/2020 FF.
The completed <em>udff</em> file is printed below:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>POTENTIAL OPLS2005

UNIT kcal/mol

ATOM_TYPE     key     element    mass     remark
Cp_alk_2020    CT3     C        12.0115    ! OPLS/2020 CH3
END ATOM_TYPE

MOLECULE_TYPE MOLECULE_KEY total_mass
pentane        PENT         72.1531  ! C5H12
END MOLECULE_TYPE



MOLECULE pentane 17 0
C1   Cp_alk_2020 -0.18
H11  HC_alkane  0.06              H11 H21 H31 H41 H51
H12  HC_alkane  0.06              |   |   |   |   |
H13  HC_alkane  0.06          H12-C1--C2--C3--C4--C5-H62
C2   Cs_alkane -0.12              |   |   |   |   |
H21  HC_alkane  0.06             H13 H22 H32 H42 H52
H22  HC_alkane  0.06
C3   Cs_alkane -0.12
H31  HC_alkane  0.06
H32  HC_alkane  0.06
C4   Cs_alkane -0.12
H41  HC_alkane  0.06
H42  HC_alkane  0.06
C5   Cp_alk_2020 -0.18
H51  HC_alkane  0.06
H62  HC_alkane  0.06
H52  HC_alkane  0.06
CONNECT C1  &gt; H11 H12 H13 C2
CONNECT H11 &gt; C1
CONNECT H12 &gt; C1
CONNECT H13 &gt; C1
CONNECT C2  &gt; C1 H21 H22 C3
CONNECT H21 &gt; C2
CONNECT H22 &gt; C2
CONNECT C3  &gt; H31 H32 C2 C4
CONNECT H31 &gt; C3
CONNECT H32 &gt; C3
CONNECT C4  &gt; H41 H42 C3 C5
CONNECT H41 &gt; C4
CONNECT H42 &gt; C4
CONNECT C5  &gt; H51 H62 H52 C4
CONNECT H51 &gt; C5
CONNECT H62 &gt; C5
CONNECT H52 &gt; C5
END MOLECULE


EQUIVALENCE
CT3  &gt;  bond_CT angle_CT dihedral_CT inv_CT imp_CT shell_CT tbp_CT
END EQUIVALENCE


VDW
CT  3.510 0.066
CT3 3.550 0.066
HC  2.480 0.026
END VDW

DIHEDRAL
CT   CT   CT   CT   0.85  -0.20  0.20
END DIHEDRAL


END POTENTIAL
</pre></div>
</div>
</section>
<section id="running-dl-field-with-udff">
<span id="with-udff"></span><h2>Running DL_FIELD with UDFF<a class="headerlink" href="#running-dl-field-with-udff" title="Link to this heading">#</a></h2>
<p>To use it, we can provide DL_FIELD with a <em>pdb</em> file with the correct atom labelling (download <a class="reference external" href="_static/pentane.pdb">here</a>). Move
this to the appropriate directory and then make sure the following two lines of the <em>control</em> file are modified:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>...
pentane.udff * Include path to .udff file (previously &#39;none&#39;)
...
tutorial_confs/pentane.pbd  * Configuration file. Change from .xyz to .pdb
</pre></div>
</div>
<p>Run DL_FIELD with</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>./dl_field
</pre></div>
</div>
<p>and verify yourself that the output files in <strong>dl_f_4.XX/output/</strong> contain the modified parameters.</p>
<p>[1]: Ghahremanpour MM, Tirado-Rives J, Jorgensen WL. Refinement of the Optimized Potentials
for Liquid Simulations Force Field for Thermodynamics and Dynamics of Liquid Alkanes.
J Phys Chem B. 2022 Aug 11;126(31):5896-5907. doi: 10.1021/acs.jpcb.2c03686. Epub 2022 Aug 1.
PMID: 35914179; PMCID: PMC9939004.</p>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="polyisoprene_melt.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Tutorial for an OPLS/2005 polyisoprene chain</p>
      </div>
    </a>
    <a class="right-next"
       href="polyethylene-xylene.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Tutorial for a Polyethylene Chain in a Xylene Solution</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#contents">Contents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#running-dl-field-without-udff-opls2005">Running DL_FIELD without UDFF (OPLS2005)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-udff-file-format">The UDFF file format</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modifying-opls2005-with-udff">Modifying OPLS2005 with UDFF</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#running-dl-field-with-udff">Running DL_FIELD with UDFF</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Lois_Smith
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      Â© Copyright 2025, Lois_Smith.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>